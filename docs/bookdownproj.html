<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Uvod u primjenu GIS-a i programskog jezika R u prostornim analizama</title>
  <meta name="description" content="Uvod u primjenu GIS-a i programskog jezika R u prostornim analizama" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Uvod u primjenu GIS-a i programskog jezika R u prostornim analizama" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Uvod u primjenu GIS-a i programskog jezika R u prostornim analizama" />
  
  
  

<meta name="author" content="Dino Bečić, mag.geogr." />


<meta name="date" content="2024-11-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Uvod u primjenu GIS-a i programskog jezika R u prostornim analizama</h1>
<p class="author"><em>Dino Bečić, mag.geogr.</em></p>
<p class="date"><em>2024-11-25</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#uvod" id="toc-uvod"><span class="toc-section-number">0.1</span> Uvod</a></li>
<li><a href="#osnove-gis-a" id="toc-osnove-gis-a"><span class="toc-section-number">0.2</span> Osnove GIS-a</a></li>
<li><a href="#prostorne-analize-u-r-u" id="toc-prostorne-analize-u-r-u"><span class="toc-section-number">0.3</span> Prostorne analize u R-u</a>
<ul>
<li><a href="#uvoz-podataka" id="toc-uvoz-podataka"><span class="toc-section-number">0.3.1</span> Uvoz podataka</a></li>
<li><a href="#analize" id="toc-analize"><span class="toc-section-number">0.3.2</span> Analize</a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Uvod u primjenu GIS-a i programskog jezika R u prostornim analizama</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="uvod" class="section level2 hasAnchor" number="0.1">
<h2 class="hasAnchor"><span class="header-section-number">0.1</span> Uvod<a href="#uvod" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div style="text-align:justify;">
<p>Analiza i materijali predstavljeni su u sklopu dvodnevne radionice “Uvod u primjenu GIS-a i programskog jezika R u prostornim analizama”, u organizaciji Hrvatskog statističkog društva i Kluba R. Radionica je osmišljena kako bi sudionike upoznala s osnovama GIS-a i vrstama prostornih podataka, te ih potom uvela u naprednije eksplorativne analize prostornih podataka.</p>
<p>Cilj ove bookdown knjige je pružiti resurse za proširivanje znanja u području prostorne analitike, kombinirajući temeljne koncepte GIS-a i napredne tehnike prostorne analize u R-u.</p>
<p>Knjiga služi kao nadopuna sadržaju radionice, sa specifičnim naglaskom na:</p>
<pre><code>Osnovna znanja o GIS-u i strukturama prostornih podataka,
Primjene prostornih analiza,
Integraciju naprednih analiza u R-u kroz praktične primjere.</code></pre>
<p>Knjiga je koncipirana kao izvor informacija koji će se kontinuirano nadopunjavati, nudeći korisnicima temeljno znanje o GIS-u, ali i vodiče koji im mogu poslužiti kao uvod u napredne prostorne analize.</p>
</div>
</div>
<div id="osnove-gis-a" class="section level2 hasAnchor" number="0.2">
<h2 class="hasAnchor"><span class="header-section-number">0.2</span> Osnove GIS-a<a href="#osnove-gis-a" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div style="text-align:justify;">
<p>Ovaj dio je predviđen za osnove GIS-a.</p>
</div>
</div>
<div id="prostorne-analize-u-r-u" class="section level2 hasAnchor" number="0.3">
<h2 class="hasAnchor"><span class="header-section-number">0.3</span> Prostorne analize u R-u<a href="#prostorne-analize-u-r-u" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div style="text-align:justify;">
<p>Dio predviđen za osnove prostornih analiza u R-u.</p>
</div>
<div id="uvoz-podataka" class="section level3 hasAnchor" number="0.3.1">
<h3 class="hasAnchor"><span class="header-section-number">0.3.1</span> Uvoz podataka<a href="#uvoz-podataka" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Učitavanje svih potrebnih biblioteka za ovaj projekt</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(sf)         <span class="co"># Biblioteka za rad s prostornim podacima (shapefiles, geometrija)</span></span></code></pre></div>
<pre><code>## Warning: package &#39;sf&#39; was built under R version 4.3.3</code></pre>
<pre><code>## Linking to GEOS 3.11.2, GDAL 3.8.2, PROJ 9.3.1; sf_use_s2() is TRUE</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)    <span class="co"># Biblioteka za naprednu vizualizaciju podataka</span></span></code></pre></div>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.3.3</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)      <span class="co"># Biblioteka za manipulaciju i filtriranje podataka</span></span></code></pre></div>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 4.3.3</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">library</span>(readxl)     <span class="co"># Biblioteka za čitanje podataka iz Excel datoteka</span></span></code></pre></div>
<pre><code>## Warning: package &#39;readxl&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">library</span>(corrplot)   <span class="co"># Biblioteka za vizualizaciju korelacijskih matrica</span></span></code></pre></div>
<pre><code>## Warning: package &#39;corrplot&#39; was built under R version 4.3.3</code></pre>
<pre><code>## corrplot 0.95 loaded</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">library</span>(spdep)      <span class="co"># Biblioteka za izračunih prostorne autokorelacije</span></span></code></pre></div>
<pre><code>## Warning: package &#39;spdep&#39; was built under R version 4.3.3</code></pre>
<pre><code>## Loading required package: spData</code></pre>
<pre><code>## Warning: package &#39;spData&#39; was built under R version 4.3.3</code></pre>
<pre><code>## To access larger datasets in this package, install the spDataLarge
## package with: `install.packages(&#39;spDataLarge&#39;,
## repos=&#39;https://nowosad.github.io/drat/&#39;, type=&#39;source&#39;)`</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Postavljanje radnog direktorija</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;C:/Users/dbecic/OneDrive - Grad Zagreb/Desktop/R Projects/RAnaliza/Data&quot;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co"># Dohvaćanje popisa svih .shp datoteka u radnom direktoriju</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>shp_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.shp$&quot;</span>)  <span class="co"># Pretražuje datoteke koje završavaju na .shp</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co"># Iteracija kroz sve pronađene shapefile datoteke</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="cf">for</span> (file <span class="cf">in</span> shp_files) {</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>  object_name <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">file_path_sans_ext</span>(file)  <span class="co"># Uklanja ekstenziju</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>  <span class="fu">assign</span>(object_name, <span class="fu">st_read</span>(file))             <span class="co"># Dinamičko učitavanje shapefile-a</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Reading layer `Bus&#39; from data source 
##   `C:\Users\dbecic\OneDrive - Grad Zagreb\Desktop\R Projects\RAnaliza\Data\Bus.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 1875 features and 1 field
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 444204.4 ymin: 5053858 xmax: 478993.9 ymax: 5088970
## Projected CRS: HTRS96 / Croatia TM
## Reading layer `Katastar&#39; from data source 
##   `C:\Users\dbecic\OneDrive - Grad Zagreb\Desktop\R Projects\RAnaliza\Data\Katastar.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 33 features and 5 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 447310.4 ymin: 5058613 xmax: 479770.8 ymax: 5088960
## Projected CRS: HTRS96 / Croatia TM
## Reading layer `Ljekarna&#39; from data source 
##   `C:\Users\dbecic\OneDrive - Grad Zagreb\Desktop\R Projects\RAnaliza\Data\Ljekarna.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 245 features and 3 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 448365.7 ymin: 5058255 xmax: 475382.1 ymax: 5085627
## Projected CRS: HTRS96 / Croatia TM
## Reading layer `Skola&#39; from data source 
##   `C:\Users\dbecic\OneDrive - Grad Zagreb\Desktop\R Projects\RAnaliza\Data\Skola.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 177 features and 5 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 446863.2 ymin: 5058245 xmax: 475496 ymax: 5088670
## Projected CRS: HTRS96 / Croatia TM
## Reading layer `Tramvaj&#39; from data source 
##   `C:\Users\dbecic\OneDrive - Grad Zagreb\Desktop\R Projects\RAnaliza\Data\Tramvaj.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 260 features and 2 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 452779.2 ymin: 5070942 xmax: 467198.9 ymax: 5080219
## Projected CRS: HTRS96 / Croatia TM
## Reading layer `Vrtic&#39; from data source 
##   `C:\Users\dbecic\OneDrive - Grad Zagreb\Desktop\R Projects\RAnaliza\Data\Vrtic.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 329 features and 6 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 448757.4 ymin: 5058059 xmax: 475318.9 ymax: 5085856
## Projected CRS: HTRS96 / Croatia TM</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># Prikaz podataka</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">summary</span>(Katastar)  <span class="co"># Prikazuje osnovne informacije o shapefile objektu (zamijenite &#39;Katastar&#39;)</span></span></code></pre></div>
<pre><code>##     OBJECTID       KO_NAZIV           SHAPE_Leng      SHAPE_Area      
##  Min.   : 1.00   Length:33          Min.   : 7540   Min.   : 2730871  
##  1st Qu.:13.00   Class :character   1st Qu.:14963   1st Qu.: 7133608  
##  Median :29.00   Mode  :character   Median :18051   Median : 8660181  
##  Mean   :28.42                      Mean   :20283   Mean   :12265300  
##  3rd Qu.:43.00                      3rd Qu.:25139   3rd Qu.:14825456  
##  Max.   :56.00                      Max.   :39142   Max.   :37871238  
##       KEY              geometry 
##  Min.   : 1   POLYGON      :33  
##  1st Qu.: 9   epsg:3765    : 0  
##  Median :17   +proj=tmer...: 0  
##  Mean   :17                     
##  3rd Qu.:25                     
##  Max.   :33</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># 3. Vizualizacija prostornih podataka</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="co"># plot() prikazuje geometriju prostornih slojeva koristeći osnovne alate u R-u</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co"># &quot;geometry&quot; je Kljuc stupca u sf objektu koji sadrži informacije o geometriji</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="fu">plot</span>(Katastar[<span class="st">&quot;geometry&quot;</span>], <span class="at">main =</span> <span class="st">&quot;KO_Kljuc&quot;</span>)  <span class="co"># Dodaje naslov grafu koristeći main = &quot;Naslov&quot;</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_1-1.png" width="672" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># 4. Učitavanje statističkih podataka iz Excel datoteke</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="co"># Definira Kljuc Excel datoteke koja sadrži dodatne informacije o nekretninama</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>excel_data <span class="ot">&lt;-</span> <span class="st">&quot;Nekretnine_Izvjesce.xlsx&quot;</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="co"># Koristi funkciju read_excel() za učitavanje podataka iz Excel datoteke u tablični format</span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>Nektretnine <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(excel_data)</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="co"># 5. Spajanje prostornih podataka s tabličnim podacima</span></span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a><span class="co"># Funkcija left_join() spaja dva podatkovna okvira na temelju zajedničkog atributa</span></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a><span class="co"># &quot;KEY&quot; je zajednički ključ koji povezuje podatke iz Excel datoteke i shapefile-a</span></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>Katastar <span class="ot">&lt;-</span> Katastar <span class="sc">%&gt;%</span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>  <span class="fu">left_join</span>(Nektretnine, <span class="at">by =</span> <span class="st">&quot;KEY&quot;</span>)</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a><span class="co"># 6. Računanje broja objekata u katastarskim općinama</span></span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a><span class="co"># Dodaje nove stupce u podatke koji broje objekte unutar svake katastarske općine</span></span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a>Katastar <span class="ot">&lt;-</span> Katastar <span class="sc">%&gt;%</span></span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a>    <span class="co"># Koristi funkciju st_intersects() za identifikaciju presjeka geometrija</span></span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a>    <span class="co"># lengths() računa broj objekata koji se nalaze unutar svake općine</span></span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a>    <span class="at">Count_Bus =</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(Katastar, Bus)),         <span class="co"># Broji autobuse</span></span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a>    <span class="at">Count_Ljekarna =</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(Katastar, Ljekarna)), <span class="co"># Broji ljekarne</span></span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a>    <span class="at">Count_Skola =</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(Katastar, Skola)),     <span class="co"># Broji škole</span></span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a>    <span class="at">Count_Tramvaj =</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(Katastar, Tramvaj)), <span class="co"># Broji tramvaje</span></span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a>    <span class="at">Count_Vrtic =</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(Katastar, Vrtic))      <span class="co"># Broji vrtiće</span></span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a>  )</span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a></span>
<span id="cb27-29"><a href="#cb27-29" tabindex="-1"></a></span>
<span id="cb27-30"><a href="#cb27-30" tabindex="-1"></a><span class="co"># 7. Osnovna vizualizacija broja autobusa po katastarskim jedinicama</span></span>
<span id="cb27-31"><a href="#cb27-31" tabindex="-1"></a><span class="co"># Koristi ggplot2 za vizualizaciju prostornih podataka</span></span>
<span id="cb27-32"><a href="#cb27-32" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar) <span class="sc">+</span></span>
<span id="cb27-33"><a href="#cb27-33" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Count_Bus)) <span class="sc">+</span>                 <span class="co"># Boji prostorne jedinice prema broju autobusa</span></span>
<span id="cb27-34"><a href="#cb27-34" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>                                <span class="co"># Primjenjuje minimalistički stil grafa</span></span>
<span id="cb27-35"><a href="#cb27-35" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Broj Autobusa po Katastarskoj jedinici&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Autobusi&quot;</span>)  <span class="co"># Dodaje naslov i legendu</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_1-2.png" width="672" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># 8. Vizualizacija s prilagođenim gradijentom boja</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="co"># Dodaje gradijent boja od crvene (malo autobusa) do tamnoplave (mnogo autobusa)</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Count_Bus)) <span class="sc">+</span>                 </span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;red&quot;</span>, <span class="at">high =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Broj Autobusa po Katastarskoj jedinici&quot;</span>,</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Autobusi&quot;</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_1-3.png" width="672" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co"># Linearni model je jednostavna metoda koja koristi jednu varijablu, poput vremena, za predviđanje trenda</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="co"># Linearni model za projekciju cijena</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="co"># Cilj: Predviđanje buduće cijene na temelju prošlih cijena.</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="co"># Ulazne varijable: Samo godine (2021, 2022, 2023).</span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="co"># Rezultat: Model daje cijenu za 2024. na temelju povijesnog trenda.</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="co"># Ograničenje: Gleda samo prošle godine i ignorira druge faktore (npr. škole, tramvaje, vrtiće).</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a><span class="co"># 9. Projekcija cijena za 2024. godinu</span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a><span class="co"># Dodaje novi stupac koji predviđa cijene nekretnina za 2024. godinu koristeći linearni model</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>Katastar <span class="ot">&lt;-</span> Katastar <span class="sc">%&gt;%</span></span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span>  <span class="co"># Omogućuje da se operacije izvode red po red</span></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>    <span class="at">MEDIJALNA_CIJENA_EUR_24 =</span> {</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>      <span class="co"># Definira ulazne podatke za regresijski model (godine i cijene)</span></span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>      years <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">2022</span>, <span class="dv">2023</span>)</span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>      prices <span class="ot">&lt;-</span> <span class="fu">c</span>(MEDIJALNA_CIJENA_EUR_21, MEDIJALNA_CIJENA_EUR_22, MEDIJALNA_CIJENA_EUR_23)</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>      </span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a>      <span class="co"># Kreira linearni model koji predviđa cijenu na temelju godina</span></span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a>      fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(prices <span class="sc">~</span> years)</span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a>      </span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a>      <span class="co"># Predviđa cijenu za 2024. godinu</span></span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a>      <span class="fu">predict</span>(fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">years =</span> <span class="dv">2024</span>))</span>
<span id="cb29-23"><a href="#cb29-23" tabindex="-1"></a>    }</span>
<span id="cb29-24"><a href="#cb29-24" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-25"><a href="#cb29-25" tabindex="-1"></a>  <span class="fu">ungroup</span>()  <span class="co"># Uklanja redno grupiranje</span></span></code></pre></div>
</div>
<div id="analize" class="section level3 hasAnchor" number="0.3.2">
<h3 class="hasAnchor"><span class="header-section-number">0.3.2</span> Analize<a href="#analize" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co"># 10. Deskriptivna statistika prosječnih cijena</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="co"># Izračunava prosječne cijene nekretnina po godinama (2021-2024)</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>prosjek_cijena_df <span class="ot">&lt;-</span> Katastar <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>    <span class="at">Prosjek_2021 =</span> <span class="fu">mean</span>(MEDIJALNA_CIJENA_EUR_21, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>    <span class="at">Prosjek_2022 =</span> <span class="fu">mean</span>(MEDIJALNA_CIJENA_EUR_22, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>    <span class="at">Prosjek_2023 =</span> <span class="fu">mean</span>(MEDIJALNA_CIJENA_EUR_23, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>    <span class="at">Prosjek_2024 =</span> <span class="fu">mean</span>(MEDIJALNA_CIJENA_EUR_24, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>  )</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a><span class="co"># Vizualizacija prosječnih cijena kroz godine koristeći stupčasti grafikon</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>godine <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;2021&quot;</span>, <span class="st">&quot;2022&quot;</span>, <span class="st">&quot;2023&quot;</span>, <span class="st">&quot;2024&quot;</span>)  <span class="co"># Definira godine</span></span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>prosjeci <span class="ot">&lt;-</span> <span class="fu">c</span>(                               <span class="co"># Definira prosječne cijene za svaku godinu</span></span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>  prosjek_cijena_df<span class="sc">$</span>Prosjek_2021,</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>  prosjek_cijena_df<span class="sc">$</span>Prosjek_2022,</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a>  prosjek_cijena_df<span class="sc">$</span>Prosjek_2023,</span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a>  prosjek_cijena_df<span class="sc">$</span>Prosjek_2024</span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a>)</span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a><span class="co"># Kreira bar grafikon za prikaz prosječnih cijena</span></span>
<span id="cb30-21"><a href="#cb30-21" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb30-22"><a href="#cb30-22" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> godine, <span class="at">y =</span> prosjeci), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span>  <span class="co"># Stupčasti grafikon</span></span>
<span id="cb30-23"><a href="#cb30-23" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-24"><a href="#cb30-24" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Prosječne medijalne cijene (2021-2024)&quot;</span>,<span class="co"># Dodaje naslov</span></span>
<span id="cb30-25"><a href="#cb30-25" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Godina&quot;</span>,                                    <span class="co"># Označava x-os</span></span>
<span id="cb30-26"><a href="#cb30-26" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Prosjek cijena (EUR)&quot;</span>                       <span class="co"># Označava y-os</span></span>
<span id="cb30-27"><a href="#cb30-27" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-28"><a href="#cb30-28" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb30-29"><a href="#cb30-29" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb30-30"><a href="#cb30-30" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),                  <span class="co"># Povećava veličinu fonta</span></span>
<span id="cb30-31"><a href="#cb30-31" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)           <span class="co"># Centriranje naslova</span></span>
<span id="cb30-32"><a href="#cb30-32" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-1.png" width="672" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># 11. Dodavanje stupaca za apsolutne i postotne promjene cijena kroz godine</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="co"># Funkcija mutate() dodaje nove stupce u podatke s izračunatim vrijednostima</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>Katastar <span class="ot">&lt;-</span> Katastar <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>    <span class="co"># Izračun apsolutnih promjena cijena između uzastopnih godina</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>    <span class="at">Promjena_21_22 =</span> MEDIJALNA_CIJENA_EUR_22 <span class="sc">-</span> MEDIJALNA_CIJENA_EUR_21,  <span class="co"># Razlika 2022. - 2021.</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>    <span class="at">Promjena_22_23 =</span> MEDIJALNA_CIJENA_EUR_23 <span class="sc">-</span> MEDIJALNA_CIJENA_EUR_22,  <span class="co"># Razlika 2023. - 2022.</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>    <span class="at">Promjena_23_24 =</span> MEDIJALNA_CIJENA_EUR_24 <span class="sc">-</span> MEDIJALNA_CIJENA_EUR_23,  <span class="co"># Razlika 2024. - 2023.</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>    </span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>    <span class="co"># Izračun postotnih promjena cijena između uzastopnih godina</span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>    <span class="at">Postotna_Promjena_21_22 =</span> (Promjena_21_22 <span class="sc">/</span> MEDIJALNA_CIJENA_EUR_21) <span class="sc">*</span> <span class="dv">100</span>,  <span class="co"># % promjena 2022. - 2021.</span></span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>    <span class="at">Postotna_Promjena_22_23 =</span> (Promjena_22_23 <span class="sc">/</span> MEDIJALNA_CIJENA_EUR_22) <span class="sc">*</span> <span class="dv">100</span>,  <span class="co"># % promjena 2023. - 2022.</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>    <span class="at">Postotna_Promjena_23_24 =</span> (Promjena_23_24 <span class="sc">/</span> MEDIJALNA_CIJENA_EUR_23) <span class="sc">*</span> <span class="dv">100</span>   <span class="co"># % promjena 2024. - 2023.</span></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>  )</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a><span class="co"># 12. Vizualizacija apsolutnih promjena cijena kroz godine</span></span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a><span class="co"># Koristimo ggplot2 za prikaz prostorne distribucije apsolutnih promjena cijena</span></span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a><span class="co"># Vizualizacija promjena cijena za razdoblje 2021.-2022.</span></span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar) <span class="sc">+</span></span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Promjena_21_22)) <span class="sc">+</span>                     <span class="co"># Boja prema apsolutnim promjenama</span></span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">high =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span>  <span class="co"># Gradijent boja od svijetloplave do tamnoplave</span></span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Promjena cijena (2021-2022)&quot;</span>,                 <span class="co"># Naslov grafa</span></span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Promjena cijene (EUR)&quot;</span>                         <span class="co"># Oznaka za legendu</span></span>
<span id="cb31-27"><a href="#cb31-27" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-28"><a href="#cb31-28" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()                                          <span class="co"># Minimalistički stil grafa</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-2.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># Vizualizacija promjena cijena za razdoblje 2022.-2023.</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Promjena_22_23)) <span class="sc">+</span>                     <span class="co"># Boja prema apsolutnim promjenama</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">high =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Promjena cijena (2022-2023)&quot;</span>,</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Promjena cijene (EUR)&quot;</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-3.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="co"># Vizualizacija promjena cijena za razdoblje 2023.-2024.</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Promjena_23_24)) <span class="sc">+</span>                     <span class="co"># Boja prema apsolutnim promjenama</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">high =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Promjena cijena (2023-2024)&quot;</span>,</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Promjena cijene (EUR)&quot;</span></span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-4.png" width="672" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co"># 13. Vizualizacija postotnih promjena cijena kroz godine</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="co"># Slično prethodnom koraku, ali sada prikazujemo postotne promjene cijena</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="co"># Vizualizacija postotnih promjena za razdoblje 2021.-2022.</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Postotna_Promjena_21_22)) <span class="sc">+</span>            <span class="co"># Boja prema postotnim promjenama</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;lightgreen&quot;</span>, <span class="at">high =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span>  <span class="co"># Gradijent boja od svijetlozelene do tamnozelene</span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Postotna promjena cijena (2021-2022)&quot;</span>,         <span class="co"># Naslov grafa</span></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Promjena cijene (%)&quot;</span>                           <span class="co"># Oznaka za legendu</span></span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-5.png" width="672" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co"># Vizualizacija postotnih promjena za razdoblje 2022.-2023.</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Postotna_Promjena_22_23)) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;lightgreen&quot;</span>, <span class="at">high =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Postotna promjena cijena (2022-2023)&quot;</span>,</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Promjena cijene (%)&quot;</span></span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-6.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co"># Vizualizacija postotnih promjena za razdoblje 2023.-2024.</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Postotna_Promjena_23_24)) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;lightgreen&quot;</span>, <span class="at">high =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Postotna promjena cijena (2023-2024)&quot;</span>,</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Promjena cijene (%)&quot;</span></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-7.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co"># Regresijski model je metoda koja analizira kako više različitih faktora zajedno utječu na neku ciljnu varijablu.</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a><span class="co"># Regresijski model za analizu utjecaja</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a><span class="co"># Cilj: Procijeniti koliko broj autobusa, tramvaja, škola i vrtića utječe na cijenu za 2024.</span></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a><span class="co"># Ulazne varijable: Broj autobusa, tramvaja, škola i vrtića.</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a><span class="co"># Rezultat: Model pokazuje koliko svaka varijabla doprinosi cijeni (ili nema utjecaja).</span></span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a><span class="co"># Ograničenje: Ne koristi povijesne podatke i pretpostavlja linearnost (da promjena u varijabli ima stalan učinak na cijenu).</span></span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a><span class="co"># 14. Regresijski model za predviđanje cijena</span></span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a><span class="co"># Kreiramo regresijski model koji predviđa cijene na temelju dostupnih atributa</span></span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>  MEDIJALNA_CIJENA_EUR_24 <span class="sc">~</span> Count_Bus <span class="sc">+</span> Count_Tramvaj <span class="sc">+</span> Count_Skola <span class="sc">+</span> Count_Vrtic,  <span class="co"># Nezavisne varijable</span></span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a>  <span class="at">data =</span> Katastar  <span class="co"># Podaci na kojima gradimo model</span></span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>)</span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a><span class="co"># Prikaz rezultata regresijskog modela</span></span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a><span class="fu">summary</span>(model)  <span class="co"># summary() daje detaljan pregled modela, uključujući koeficijente i statistike</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = MEDIJALNA_CIJENA_EUR_24 ~ Count_Bus + Count_Tramvaj + 
##     Count_Skola + Count_Vrtic, data = Katastar)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1458.31  -177.95    68.61   261.19   628.64 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2027.7363   200.8145  10.098 7.76e-11 ***
## Count_Bus        1.1148     5.2760   0.211    0.834    
## Count_Tramvaj    0.1771    16.2024   0.011    0.991    
## Count_Skola     -6.8070    65.1977  -0.104    0.918    
## Count_Vrtic     34.0696    25.1498   1.355    0.186    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 491.2 on 28 degrees of freedom
## Multiple R-squared:  0.2975, Adjusted R-squared:  0.1972 
## F-statistic: 2.965 on 4 and 28 DF,  p-value: 0.03682</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># 15. Uklanjanje geometrije iz sf objekta</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="co"># sf objekti sadrže geometrijske podatke, ali za statističke analize trebamo samo atributne podatke</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>Katastar_numeric <span class="ot">&lt;-</span> Katastar <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()  <span class="co"># st_drop_geometry() uklanja stupac geometrije iz sf objekta</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a><span class="co"># 16. Kreiranje korelacijske matrice za numeričke varijable</span></span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a><span class="co"># Korelacijska matrica pokazuje međusobne odnose između numeričkih varijabli</span></span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> Katastar_numeric <span class="sc">%&gt;%</span></span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>  <span class="fu">select</span>(Count_Bus, Count_Tramvaj, Count_Skola, Count_Vrtic) <span class="sc">%&gt;%</span>  <span class="co"># Odabiremo relevantne stupce</span></span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>)  <span class="co"># cor() izračunava korelacije, ignorirajući nedostajuće vrijednosti</span></span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a><span class="co"># 17. Vizualizacija korelacijske matrice</span></span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a><span class="co"># Koristimo corrplot za prikaz korelacijskih vrijednosti</span></span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a><span class="fu">corrplot</span>(</span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>  correlation_matrix,    <span class="co"># Korelacijska matrica</span></span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;number&quot;</span>,     <span class="co"># Prikazuje brojeve unutar ćelija matrice</span></span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;upper&quot;</span>,        <span class="co"># Prikazuje samo gornji trokut matrice (za uredniji prikaz)</span></span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a>  <span class="at">tl.col =</span> <span class="st">&quot;black&quot;</span>,      <span class="co"># Postavlja boju oznaka varijabli na crnu</span></span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a>  <span class="at">tl.srt =</span> <span class="dv">45</span>,           <span class="co"># Rotira oznake varijabli za 45 stupnjeva radi bolje čitljivosti</span></span>
<span id="cb39-22"><a href="#cb39-22" tabindex="-1"></a>  <span class="at">addCoef.col =</span> <span class="st">&quot;black&quot;</span>  <span class="co"># Dodaje numeričke vrijednosti koeficijenata korelacije unutar ćelija</span></span>
<span id="cb39-23"><a href="#cb39-23" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-8.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co"># K-means je metoda za grupiranje podataka u K grupa (klastera) na temelju sličnosti. Radi na sljedeći način:</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a><span class="co"># Početna postavka: Nasumično odabere K centara (tzv. centrioda) za početak.</span></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a><span class="co"># Dodjeljivanje: Svakom podatku dodijeli klaster prema najbližem centru.</span></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a><span class="co"># Ažuriranje: Ponovno izračuna centar svakog klastera kao prosjek svih podataka u tom klasteru.</span></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a><span class="co"># Ponavljanje: Ponavlja dodjeljivanje i ažuriranje dok se centri više ne mijenjaju (ili nakon određenog broja iteracija).</span></span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a><span class="co"># Cilj K-meansa je napraviti klastere koji su što sličniji unutar klastera i što različitiji između klastera.</span></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a><span class="co"># 18. Priprema podataka za kmeans</span></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a><span class="co"># Selektiramo stupac MEDIJALNA_CIJENA_EUR_24 iz dataset-a Katastar.</span></span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a><span class="co"># Ovo su vrijednosti koje koristimo za klasteriranje.</span></span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a>cijene <span class="ot">&lt;-</span> Katastar<span class="sc">$</span>MEDIJALNA_CIJENA_EUR_24</span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" tabindex="-1"></a><span class="co"># Provjera nedostajućih vrijednosti</span></span>
<span id="cb40-15"><a href="#cb40-15" tabindex="-1"></a><span class="co"># K-means algoritam ne može raditi s NA vrijednostima. Koristimo na.omit() za uklanjanje redaka s NA.</span></span>
<span id="cb40-16"><a href="#cb40-16" tabindex="-1"></a>cijene <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(cijene)</span>
<span id="cb40-17"><a href="#cb40-17" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" tabindex="-1"></a><span class="co"># 19. Normalizacija podataka</span></span>
<span id="cb40-19"><a href="#cb40-19" tabindex="-1"></a><span class="co"># K-means je osjetljiv na skalu podataka jer koristi euklidsku udaljenost.</span></span>
<span id="cb40-20"><a href="#cb40-20" tabindex="-1"></a><span class="co"># Normaliziramo cijene kako bismo ih smjestili u raspon od 0 do 1.</span></span>
<span id="cb40-21"><a href="#cb40-21" tabindex="-1"></a>cijene_norm <span class="ot">&lt;-</span> (cijene <span class="sc">-</span> <span class="fu">min</span>(cijene)) <span class="sc">/</span> (<span class="fu">max</span>(cijene) <span class="sc">-</span> <span class="fu">min</span>(cijene))</span>
<span id="cb40-22"><a href="#cb40-22" tabindex="-1"></a><span class="co"># Normalizacija osigurava da veće vrijednosti ne dominiraju nad manjima tijekom grupiranja.</span></span>
<span id="cb40-23"><a href="#cb40-23" tabindex="-1"></a></span>
<span id="cb40-24"><a href="#cb40-24" tabindex="-1"></a><span class="co"># 20. Odabir broja klastera (K)</span></span>
<span id="cb40-25"><a href="#cb40-25" tabindex="-1"></a><span class="co"># K-means zahtijeva unaprijed zadani broj klastera, K.</span></span>
<span id="cb40-26"><a href="#cb40-26" tabindex="-1"></a><span class="co"># Metoda &quot;elbow&quot; koristi ukupan trošak (unutar-klastersku sumu kvadrata) za svaki broj K.</span></span>
<span id="cb40-27"><a href="#cb40-27" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Postavljamo seed za reproducibilnost.</span></span>
<span id="cb40-28"><a href="#cb40-28" tabindex="-1"></a>wss <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(k) {</span>
<span id="cb40-29"><a href="#cb40-29" tabindex="-1"></a>  <span class="fu">kmeans</span>(cijene_norm, <span class="at">centers =</span> k, <span class="at">nstart =</span> <span class="dv">20</span>)<span class="sc">$</span>tot.withinss</span>
<span id="cb40-30"><a href="#cb40-30" tabindex="-1"></a>})</span>
<span id="cb40-31"><a href="#cb40-31" tabindex="-1"></a><span class="co"># $tot.withinss: Ukupna suma kvadrata udaljenosti unutar klastera za zadani broj K.</span></span>
<span id="cb40-32"><a href="#cb40-32" tabindex="-1"></a><span class="co"># nstart = 20: Ponavlja inicijalizaciju centara 20 puta i odabire najbolje rješenje.</span></span>
<span id="cb40-33"><a href="#cb40-33" tabindex="-1"></a></span>
<span id="cb40-34"><a href="#cb40-34" tabindex="-1"></a><span class="co"># Vizualizacija metode &quot;elbow&quot;</span></span>
<span id="cb40-35"><a href="#cb40-35" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, wss, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">frame =</span> <span class="cn">FALSE</span>,</span>
<span id="cb40-36"><a href="#cb40-36" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Broj klastera K&quot;</span>,</span>
<span id="cb40-37"><a href="#cb40-37" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Unutar-klasterska suma kvadrata&quot;</span>,</span>
<span id="cb40-38"><a href="#cb40-38" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Odabir broja klastera metodom &#39;Elbow&#39;&quot;</span>)</span>
<span id="cb40-39"><a href="#cb40-39" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)  <span class="co"># Pretpostavljeni optimalni K.</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-9.png" width="672" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># Na &quot;koljenu&quot; grafa (nagli pad troška se smanjuje) odabiremo optimalan broj klastera (npr. K = 3).</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="co"># 21. Primjena K-means algoritma</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a><span class="co"># Nakon što smo odabrali K, primjenjujemo K-means klasteriranje.</span></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>kmeans_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cijene_norm, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">20</span>)</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a><span class="co"># centers = 3: Koristimo 3 klastera (pretpostavka iz metode &quot;elbow&quot;).</span></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a><span class="co"># nstart = 20: Ponavljamo inicijalizaciju kako bismo izbjegli lokalne minimume.</span></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a><span class="co"># Dodajemo rezultate klasteriranja u originalni dataset Katastar.</span></span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a><span class="co"># Na taj način povezujemo rezultate klasteriranja s prostornim jedinicama.</span></span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>Katastar<span class="sc">$</span>Cluster <span class="ot">&lt;-</span> <span class="cn">NA</span>  <span class="co"># Inicijaliziramo stupac za klastere.</span></span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>Katastar<span class="sc">$</span>Cluster[<span class="sc">!</span><span class="fu">is.na</span>(Katastar<span class="sc">$</span>MEDIJALNA_CIJENA_EUR_24)] <span class="ot">&lt;-</span> kmeans_result<span class="sc">$</span>cluster</span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a><span class="co"># Svaka jedinica dobiva pridruženi klaster iz K-means algoritma.</span></span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a><span class="co"># 22. Vizualizacija klastera na prostornim podacima</span></span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a><span class="co"># Prikazujemo rezultate klasteriranja na prostornom grafu.</span></span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar) <span class="sc">+</span></span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(Cluster))) <span class="sc">+</span>  <span class="co"># Koristimo klastere za bojanje.</span></span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="sc">+</span>  <span class="co"># Dodajemo prilagođene boje.</span></span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb41-21"><a href="#cb41-21" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;K-means klasteriranje: Medijalne cijene za 2024.&quot;</span>,</span>
<span id="cb41-22"><a href="#cb41-22" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Klaster&quot;</span></span>
<span id="cb41-23"><a href="#cb41-23" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-24"><a href="#cb41-24" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-10.png" width="672" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="co"># Prostorni prikaz omogućuje uvid u geografski raspored klastera.</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a><span class="co"># 23. Interpretacija klastera</span></span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a><span class="co"># Analiziramo prosječne medijalne cijene i broj općina u svakom klasteru.</span></span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>cluster_stats <span class="ot">&lt;-</span> Katastar <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a>  <span class="fu">group_by</span>(Cluster) <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a>    Prosječna<span class="at">_Cijena =</span> <span class="fu">mean</span>(MEDIJALNA_CIJENA_EUR_24, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a>    Broj_Općina <span class="ot">=</span> <span class="fu">n</span>()</span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a>  )</span>
<span id="cb42-11"><a href="#cb42-11" tabindex="-1"></a><span class="fu">print</span>(cluster_stats)</span></code></pre></div>
<pre><code>## Simple feature collection with 3 features and 3 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 447310.4 ymin: 5058613 xmax: 479770.8 ymax: 5088960
## Projected CRS: HTRS96 / Croatia TM
## # A tibble: 3 × 4
##   Cluster Prosječna_Cijena Broj_Općina                                  geometry
##     &lt;int&gt;            &lt;dbl&gt;       &lt;int&gt;                        &lt;MULTIPOLYGON [m]&gt;
## 1       1            2281.          15 (((456752.1 5061059, 456749.5 5061084, 4…
## 2       2            2817.          14 (((453775 5071248, 453775.5 5071249, 453…
## 3       3            1216.           4 (((453378.4 5068928, 453393 5068930, 453…</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co"># Rezultati prikazuju osnovne karakteristike svakog klastera.</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a><span class="co"># Dodatno možemo prikazati boxplot za usporedbu cijena između klastera.</span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Cluster), <span class="at">y =</span> MEDIJALNA_CIJENA_EUR_24, <span class="at">fill =</span> <span class="fu">factor</span>(Cluster))) <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Distribucija medijalnih cijena po klasterima&quot;</span>,</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Klaster&quot;</span>,</span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Medijalna cijena (EUR)&quot;</span></span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-11.png" width="672" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="co"># Boxplot daje pregled raspona cijena unutar svakog klastera, uključujući medijan i ekstreme.</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a><span class="co"># Prostorna autokorelacija pokazuje postoji li prostorna povezanost između vrijednosti neke varijable (npr. cijena nekretnina)</span></span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a><span class="co"># u susjednim prostornim jedinicama. Koristimo Moranov indeks za kvantifikaciju prostorne autokorelacije, a on može biti:</span></span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a><span class="co"># Globalni Moranov indeks: Pokazuje ukupnu prostornu autokorelaciju u cijelom području.</span></span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a><span class="co"># Lokalni Moranov indeks (LISA): Identificira lokalne klastere i prostorne anomalije.</span></span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a><span class="co"># Globalni Moranov indeks je jedna vrijednost koja mjeri ukupnu prostornu povezanost. Vrijednosti su:</span></span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a><span class="co"># Blizu 1: Jaka pozitivna prostorna autokorelacija (slične vrijednosti grupirane zajedno).</span></span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a><span class="co"># Blizu -1: Jaka negativna prostorna autokorelacija (različite vrijednosti susjedne).</span></span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a><span class="co"># Oko 0: Nema prostorne autokorelacije (nasumičan raspored).</span></span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a><span class="co"># 24. Kreiranje susjedne matrice (Queen kriterij)</span></span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a><span class="co"># Queen kriterij definira susjedne jedinice na način da prostornoj jedinici smatra susjedom svaku jedinicu </span></span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a><span class="co"># koja dijeli bilo koju granicu ili kut (kao kod kraljice u šahu). </span></span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a><span class="co"># To znači da jedinice koje dijele i dijagonalne točke smatra susjedima.</span></span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" tabindex="-1"></a><span class="co"># Koristimo prostorne geometrije iz objekta Katastar</span></span>
<span id="cb45-22"><a href="#cb45-22" tabindex="-1"></a>neighbours <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(Katastar, <span class="at">queen =</span> <span class="cn">TRUE</span>)  <span class="co"># poly2nb koristi geometriju za određivanje susjeda (Queen kriterij)</span></span>
<span id="cb45-23"><a href="#cb45-23" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(neighbours, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)  <span class="co"># Konverzija u težinsku matricu s normaliziranim težinama</span></span>
<span id="cb45-24"><a href="#cb45-24" tabindex="-1"></a></span>
<span id="cb45-25"><a href="#cb45-25" tabindex="-1"></a><span class="co"># 25. Izračun Globalnog Moranovog indeksa</span></span>
<span id="cb45-26"><a href="#cb45-26" tabindex="-1"></a><span class="co"># Analiziramo MEDIJALNA_CIJENA_EUR_24</span></span>
<span id="cb45-27"><a href="#cb45-27" tabindex="-1"></a>moran_global <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(Katastar<span class="sc">$</span>MEDIJALNA_CIJENA_EUR_24, weights)</span>
<span id="cb45-28"><a href="#cb45-28" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" tabindex="-1"></a><span class="co"># 26. Prikaz rezultata</span></span>
<span id="cb45-30"><a href="#cb45-30" tabindex="-1"></a><span class="fu">print</span>(moran_global)</span></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  Katastar$MEDIJALNA_CIJENA_EUR_24  
## weights: weights    
## 
## Moran I statistic standard deviate = 3.8158, p-value = 6.788e-05
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##        0.38314787       -0.03125000        0.01179427</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># Lokalni Moranov indeks</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="co"># Lokalni Moranov indeks pokazuje prostorne klastere:</span></span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="co"># High-High klasteri (HH): Područja gdje su visoke vrijednosti grupirane.</span></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a><span class="co"># Low-Low klasteri (LL): Područja gdje su niske vrijednosti grupirane.</span></span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a><span class="co"># High-Low ili Low-High klasteri (HL/LH): Prostorne anomalije (visoka vrijednost okružena niskima ili obrnuto).</span></span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a><span class="co"># 27. Izračun lokalnog Moranovog indeksa (Local Moran&#39;s I)</span></span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>local_moran <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(Katastar<span class="sc">$</span>MEDIJALNA_CIJENA_EUR_24, weights)  <span class="co"># &#39;weights&#39; je matrica susjedstva izračunata ranije</span></span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a><span class="co"># 27. Izračun lokalnog Moranovog indeksa (Local Moran&#39;s I)</span></span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a><span class="co"># Funkcija `localmoran` iz paketa `spdep` koristi prostorne podatke (npr. cijene nekretnina)</span></span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a><span class="co"># i prostornu težinsku matricu (`weights`) kako bi izračunala lokalni Moranov indeks.</span></span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a><span class="co"># Rezultat sadrži informacije o prostornoj autokorelaciji za svaku jedinicu.</span></span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>local_moran <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(Katastar<span class="sc">$</span>MEDIJALNA_CIJENA_EUR_24, weights)</span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a><span class="co"># 28. Kombinacija rezultata u podatkovni okvir</span></span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a><span class="co"># Rezultati lokalnog Moranovog indeksa se transformiraju u novi podatkovni okvir.</span></span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a><span class="co"># Svaka jedinica dobiva pripadajuće vrijednosti:</span></span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a><span class="co"># - `Local_Morans_I`: Vrijednost lokalnog Moranovog indeksa</span></span>
<span id="cb47-21"><a href="#cb47-21" tabindex="-1"></a><span class="co"># - `Expected`: Očekivana vrijednost indeksa</span></span>
<span id="cb47-22"><a href="#cb47-22" tabindex="-1"></a><span class="co"># - `Std_Observed`: Standardizirane opažene vrijednosti</span></span>
<span id="cb47-23"><a href="#cb47-23" tabindex="-1"></a>local_moran_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb47-24"><a href="#cb47-24" tabindex="-1"></a>  <span class="at">Kljuc =</span> Katastar<span class="sc">$</span>KEY,  <span class="co"># Jedinstveni identifikator prostorne jedinice</span></span>
<span id="cb47-25"><a href="#cb47-25" tabindex="-1"></a>  <span class="at">Local_Morans_I =</span> local_moran[, <span class="dv">1</span>],  <span class="co"># Vrijednosti lokalnog Moranovog indeksa</span></span>
<span id="cb47-26"><a href="#cb47-26" tabindex="-1"></a>  <span class="at">Expected =</span> local_moran[, <span class="dv">2</span>],        <span class="co"># Očekivane vrijednosti</span></span>
<span id="cb47-27"><a href="#cb47-27" tabindex="-1"></a>  <span class="at">Std_Observed =</span> local_moran[, <span class="dv">3</span>],   <span class="co"># Standardizirane opažene vrijednosti</span></span>
<span id="cb47-28"><a href="#cb47-28" tabindex="-1"></a>  <span class="at">LISA_P =</span> local_moran[, <span class="dv">5</span>],         <span class="co"># P-vrijednosti za lokalni Moranov indeks</span></span>
<span id="cb47-29"><a href="#cb47-29" tabindex="-1"></a>  <span class="at">LISA_Sig =</span> <span class="fu">ifelse</span>(local_moran[, <span class="dv">5</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">&quot;Significant&quot;</span>, <span class="st">&quot;Not Significant&quot;</span>)  <span class="co"># Oznaka značajnosti</span></span>
<span id="cb47-30"><a href="#cb47-30" tabindex="-1"></a>)</span>
<span id="cb47-31"><a href="#cb47-31" tabindex="-1"></a></span>
<span id="cb47-32"><a href="#cb47-32" tabindex="-1"></a><span class="co"># 29. Spremanje dodatnih atributa, uključujući kvadrante</span></span>
<span id="cb47-33"><a href="#cb47-33" tabindex="-1"></a><span class="co"># Kreiramo dodatni podatkovni okvir s kvadrantima koji opisuju prostorne klastere:</span></span>
<span id="cb47-34"><a href="#cb47-34" tabindex="-1"></a><span class="co"># - Kvadranti se odnose na kategorije (npr. High-High, Low-Low, High-Low, Low-High),</span></span>
<span id="cb47-35"><a href="#cb47-35" tabindex="-1"></a><span class="co">#   koje identificiraju vrstu prostornog odnosa između vrijednosti.</span></span>
<span id="cb47-36"><a href="#cb47-36" tabindex="-1"></a>quadr_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb47-37"><a href="#cb47-37" tabindex="-1"></a>  <span class="at">Kljuc =</span> Katastar<span class="sc">$</span>KEY,  <span class="co"># Jedinstveni identifikator prostorne jedinice</span></span>
<span id="cb47-38"><a href="#cb47-38" tabindex="-1"></a>  <span class="at">Quadr =</span> <span class="fu">attr</span>(local_moran, <span class="st">&quot;quadr&quot;</span>),  <span class="co"># Kvadranti (ako ih algoritam generira automatski)</span></span>
<span id="cb47-39"><a href="#cb47-39" tabindex="-1"></a>  <span class="at">MED_CIJENA =</span> Katastar<span class="sc">$</span>MEDIJALNA_CIJENA_EUR_24  <span class="co"># Varijabla koju analiziramo (cijene nekretnina)</span></span>
<span id="cb47-40"><a href="#cb47-40" tabindex="-1"></a>)</span>
<span id="cb47-41"><a href="#cb47-41" tabindex="-1"></a></span>
<span id="cb47-42"><a href="#cb47-42" tabindex="-1"></a><span class="co"># 30. Ispis osnovnih informacija o objektu `local_moran`</span></span>
<span id="cb47-43"><a href="#cb47-43" tabindex="-1"></a><span class="co"># Ovdje ispisujemo dodatne informacije pohranjene kao atribute objekta `local_moran`:</span></span>
<span id="cb47-44"><a href="#cb47-44" tabindex="-1"></a><span class="co"># - `call`: Prikazuje kako je funkcija `localmoran` pozvana</span></span>
<span id="cb47-45"><a href="#cb47-45" tabindex="-1"></a><span class="co"># - `class`: Pokazuje tip objekta (klasa), što može pomoći u daljnjoj analizi</span></span>
<span id="cb47-46"><a href="#cb47-46" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">attr</span>(local_moran, <span class="st">&quot;call&quot;</span>))   <span class="co"># Prikaz funkcijskog poziva</span></span></code></pre></div>
<pre><code>## localmoran(x = Katastar$MEDIJALNA_CIJENA_EUR_24, listw = weights)</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">attr</span>(local_moran, <span class="st">&quot;class&quot;</span>))  <span class="co"># Prikaz klase objekta</span></span></code></pre></div>
<pre><code>## [1] &quot;localmoran&quot; &quot;matrix&quot;     &quot;array&quot;</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co"># 31. Spajanje kvadranata s prostornim podacima</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a><span class="co"># Prostorni podaci (`Katastar`) se proširuju informacijama o kvadrantima.</span></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a><span class="co"># Spajanje se vrši pomoću jedinstvenog identifikatora (`KEY`), čime svaka jedinica</span></span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a><span class="co"># dobiva svoj odgovarajući kvadrant.</span></span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>katastar_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(Katastar, quadr_df, <span class="at">by.x =</span> <span class="st">&quot;KEY&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;Kljuc&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a><span class="co"># 32. Spajanje lokalnog Moranovog indeksa s podacima</span></span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a><span class="co"># Prostornim podacima dodajemo rezultate lokalnog Moranovog indeksa.</span></span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a><span class="co"># Svaka jedinica sada sadrži:</span></span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a><span class="co"># - Prostorne informacije</span></span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a><span class="co"># - Vrijednosti lokalnog Moranovog indeksa</span></span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a>Katastar_Analitika <span class="ot">&lt;-</span> <span class="fu">merge</span>(katastar_data, local_moran_df, <span class="at">by.x =</span> <span class="st">&quot;KEY&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;Kljuc&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a><span class="co"># 33. Ispis konačnih podataka</span></span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a><span class="co"># Prikazujemo proširene podatke koji uključuju informacije o kvadrantima i lokalnom</span></span>
<span id="cb51-16"><a href="#cb51-16" tabindex="-1"></a><span class="co"># Moranovom indeksu za daljnju analizu ili vizualizaciju.</span></span>
<span id="cb51-17"><a href="#cb51-17" tabindex="-1"></a><span class="fu">print</span>(Katastar_Analitika)</span></code></pre></div>
<pre><code>## Simple feature collection with 33 features and 40 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 447310.4 ymin: 5058613 xmax: 479770.8 ymax: 5088960
## Projected CRS: HTRS96 / Croatia TM
## First 10 features:
##    KEY OBJECTID         KO_NAZIV SHAPE_Leng SHAPE_Area               KO
## 1    1        1        ČRNOMEREC   13830.45    6324009        Črnomerec
## 2    2        2          ČUČERJE   25139.21    9747124          Čučerje
## 3    3        4          DUBRAVA   16318.71   10491758          Dubrava
## 4    4        6            KLARA   14962.60    8639573            Klara
## 5    5        7    GORNJE VRAPČE   24968.11   14288834    Gornje Vrapče
## 6    6        8 GORNJI STENJEVEC   26229.04   17188795 Gornji Stenjevec
## 7    7       10         MIKULIĆI   15135.00    5214196         Mikulići
## 8    8       12       TREŠNJEVKA   11069.67    3788989       Trešnjevka
## 9    9       13            TRNJE   15133.50    7375739            Trnje
## 10  10       18         MAKSIMIR   15105.95    6828886         Maksimir
##    BROJ_TRANSAKCIJA_21 MEDIJALNA_CIJENA_EUR_21 MEDIJALNA_VELICINA_21
## 1                  652                1677.253                    66
## 2                   NA                      NA                    NA
## 3                  472                1459.533                    57
## 4                  568                1477.253                    62
## 5                   33                1550.840                    68
## 6                   76                1426.987                    78
## 7                  100                1303.867                    98
## 8                 1122                1737.373                    59
## 9                  711                1802.547                    60
## 10                 176                1746.080                    70
##    MEDIJALNA_STAROST_21 BROJ_TRANSAKCIJA_22 MEDIJALNA_CIJENA_EUR_22
## 1                    16                 485                  2002.3
## 2                    NA                  12                  1575.1
## 3                    41                 598                  1901.5
## 4                    12                 467                  1865.7
## 5                    14                  34                  1598.0
## 6                    12                  38                  1748.3
## 7                    14                  72                  1570.0
## 8                    33                 984                  2052.0
## 9                    38                 517                  2181.5
## 10                   51                 189                  1993.5
##    MEDIJALNA_VELICINA_22 MEDIJALNA_STAROST_22 BROJ_TRANSAKCIJA_23
## 1                   66.8                   62                 381
## 2                   63.3                    0                  NA
## 3                   56.7                   16                 548
## 4                   57.0                   14                 677
## 5                   62.6                   16                  27
## 6                   82.7                   13                  29
## 7                   95.1                   14                  60
## 8                   56.2                   48                 427
## 9                   57.1                   47                 472
## 10                  72.9                   52                 175
##    MEDIJALNA_CIJENA_EUR_23 MEDIJALNA_VELICINA_23 MEDIJALNA_STAROST_23 Count_Bus
## 1                  2452.60                 65.40                   61        70
## 2                       NA                    NA                   NA        37
## 3                  2028.40                 57.90                   15       122
## 4                  2105.90                 65.60                    1        45
## 5                  1967.90                 66.60                   16        28
## 6                  2329.80                 90.30                   14        42
## 7                  1925.10                 75.20                   18        36
## 8                  2426.95                 54.85                   51        37
## 9                  2612.90                 57.60                   44        47
## 10                 2439.80                 79.90                   43        54
##    Count_Ljekarna Count_Skola Count_Tramvaj Count_Vrtic MEDIJALNA_CIJENA_EUR_24
## 1              15           9            15          15                2819.398
## 2               1           2             0           2                1575.100
## 3              17          12            20          24                2365.344
## 4               8           4             7           8                2444.931
## 5               1           1             0           3                2122.640
## 6               0           0             0           2                2737.842
## 7               1           1             0           2                2220.889
## 8              19          10            34          15                2761.684
## 9              18          11            29          16                3009.336
## 10              9           7             9           7                2753.513
##    Promjena_21_22 Promjena_22_23 Promjena_23_24 Postotna_Promjena_21_22
## 1        325.0467         450.30       366.7978               19.379700
## 2              NA             NA             NA                      NA
## 3        441.9667         126.90       336.9444               30.281368
## 4        388.4467         240.20       339.0311               26.295196
## 5         47.1600         369.90       154.7400                3.040933
## 6        321.3133         581.50       408.0422               22.516912
## 7        266.1333         355.10       295.7889               20.411085
## 8        314.6267         374.95       334.7344               18.109330
## 9        378.9533         431.40       396.4356               21.023219
## 10       247.4200         446.30       313.7133               14.170027
##    Postotna_Promjena_22_23 Postotna_Promjena_23_24 Cluster Quadr.mean
## 1                22.489137               14.955467       2  High-High
## 2                       NA                      NA       3    Low-Low
## 3                 6.673679               16.611341       1    Low-Low
## 4                12.874524               16.099108       1  High-High
## 5                23.147685                7.863204       1   Low-High
## 6                33.260882               17.514045       2  High-High
## 7                22.617834               15.364858       1   Low-High
## 8                18.272417               13.792391       2  High-High
## 9                19.775384               15.172244       2  High-High
## 10               22.387760               12.858158       2  High-High
##    Quadr.median Quadr.pysal MED_CIJENA Local_Morans_I      Expected
## 1     High-High   High-High   2819.398    0.431584507 -0.0207773450
## 2       Low-Low     Low-Low   1575.100    1.182634846 -0.0693345572
## 3       Low-Low    Low-High   2365.344   -0.003245774 -0.0000206200
## 4     High-High   High-High   2444.931    0.073017735 -0.0004631338
## 5      Low-High    Low-High   2122.640   -0.197473774 -0.0070588530
## 6     High-High   High-High   2737.842    0.300020166 -0.0137915161
## 7      Low-High    Low-High   2220.889   -0.119587965 -0.0026878393
## 8     High-High   High-High   2761.684    0.517282294 -0.0156862262
## 9     High-High   High-High   3009.336    0.614020207 -0.0425764256
## 10     High-Low   High-High   2753.513    0.137798661 -0.0150231479
##    Std_Observed     LISA_P        LISA_Sig                       geometry
## 1  1.169547e-01 0.18591909 Not Significant POLYGON ((455881.1 5076734,...
## 2  1.030355e+00 0.21743043 Not Significant POLYGON ((464926.9 5088757,...
## 3  9.511612e-05 0.74087734 Not Significant POLYGON ((463370 5078100, 4...
## 4  3.449495e-03 0.21089330 Not Significant POLYGON ((456859.7 5068900,...
## 5  5.222855e-02 0.40473438 Not Significant POLYGON ((452116.8 5078813,...
## 6  1.013517e-01 0.32427051 Not Significant POLYGON ((447310.4 5077796,...
## 7  1.997490e-02 0.40816462 Not Significant POLYGON ((454970 5078115, 4...
## 8  5.870110e-02 0.02782280     Significant POLYGON ((456548.8 5074605,...
## 9  1.549771e-01 0.09533949 Not Significant POLYGON ((457466.4 5071842,...
## 10 6.825922e-02 0.55859408 Not Significant POLYGON ((460239.4 5078152,...</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="co"># Prostorni zaostatak je prosjek ili ponderirana suma vrijednosti od prostorno susjednih jedinica za određenu varijablu. </span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a><span class="co"># Drugim riječima, pokazuje koliko je vrijednost u nekoj jedinici povezana s vrijednostima njenih susjeda, koristeći prostornu težinsku matricu.</span></span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a><span class="co"># Prostorni zaostatak omogućuje razumijevanje kako prostorna okolina (npr. cijene u susjednim područjima) utječe na vrijednosti u pojedinoj jedinici.</span></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a><span class="co"># lag.listw() funkcija:</span></span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a><span class="co"># - `weights`: Prostorna težinska matrica (definira odnose između susjeda).</span></span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a><span class="co"># - `Katastar_Analitika$MEDIJALNA_CIJENA_EUR_24`: Varijabla za koju računamo prostorni zaostatak.</span></span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a><span class="co"># Što je prostorni zaostatak?</span></span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a><span class="co"># Prostorni zaostatak (eng. Spatial Lag) pokazuje kako se vrijednost varijable u nekoj prostornoj jedinici odnosi na </span></span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a><span class="co"># prosjek (ili ponderiranu sumu) vrijednosti iste varijable u susjednim jedinicama.</span></span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a><span class="co"># Jednostavno objašnjenje:</span></span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a><span class="co"># Umjesto da analiziramo samo cijene unutar svake katastarske jedinice, prostorni zaostatak uključuje i utjecaj cijena u okolnim jedinicama.</span></span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a><span class="co"># Primjer:</span></span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a><span class="co"># - Imamo jedinicu s cijenom **1000 EUR/m²**.</span></span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a><span class="co"># - Njeni susjedi imaju sljedeće cijene:</span></span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a><span class="co">#     * Prva susjedna jedinica: **1100 EUR/m²**</span></span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a><span class="co">#     * Druga susjedna jedinica: **1200 EUR/m²**</span></span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a><span class="co">#     * Treća susjedna jedinica: **1300 EUR/m²**</span></span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a><span class="co"># - Prostorni zaostatak izračunavamo kao prosjek:</span></span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a><span class="co"># - Što to znači?</span></span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a><span class="co">#     * Vrijednost prostornog zaostatka za tu jedinicu nije jednaka njenoj vlastitoj cijeni (**1000 EUR/m²**), </span></span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a><span class="co">#       već prosjeku susjednih jedinica (**1200 EUR/m²**).</span></span>
<span id="cb53-26"><a href="#cb53-26" tabindex="-1"></a></span>
<span id="cb53-27"><a href="#cb53-27" tabindex="-1"></a><span class="co"># Kako se prostorni zaostatak računa?</span></span>
<span id="cb53-28"><a href="#cb53-28" tabindex="-1"></a><span class="co"># - Prostorni zaostatak se računa koristeći prostornu težinsku matricu, koja definira odnose između susjednih jedinica.</span></span>
<span id="cb53-29"><a href="#cb53-29" tabindex="-1"></a><span class="co"># - Težinska matrica kaže koliko svaka susjedna jedinica doprinosi računanju zaostatka.</span></span>
<span id="cb53-30"><a href="#cb53-30" tabindex="-1"></a><span class="co"># - Ako koristimo **ponderiranu matricu** (gdje susjedi imaju različitu &quot;težinu&quot;), zaostatak bi bio izračunat kao **ponderirani prosjek**.</span></span>
<span id="cb53-31"><a href="#cb53-31" tabindex="-1"></a></span>
<span id="cb53-32"><a href="#cb53-32" tabindex="-1"></a><span class="co"># Korištena funkcija:</span></span>
<span id="cb53-33"><a href="#cb53-33" tabindex="-1"></a><span class="co"># spatial_lag &lt;- lag.listw(weights, Katastar_Analitika$MEDIJALNA_CIJENA_EUR_24)</span></span>
<span id="cb53-34"><a href="#cb53-34" tabindex="-1"></a><span class="co"># Ovdje:</span></span>
<span id="cb53-35"><a href="#cb53-35" tabindex="-1"></a><span class="co"># - `weights` je prostorna težinska matrica.</span></span>
<span id="cb53-36"><a href="#cb53-36" tabindex="-1"></a><span class="co"># - `Katastar_Analitika$MEDIJALNA_CIJENA_EUR_24` je varijabla čije prostorne zaostatke želimo izračunati (medijalne cijene nekretnina).</span></span>
<span id="cb53-37"><a href="#cb53-37" tabindex="-1"></a></span>
<span id="cb53-38"><a href="#cb53-38" tabindex="-1"></a><span class="co"># Prostorni zaostatak omogućuje dodavanje nove dimenzije analizi:</span></span>
<span id="cb53-39"><a href="#cb53-39" tabindex="-1"></a><span class="co"># - Vrijednost prostornog zaostatka za svaku jedinicu uzima u obzir samo susjedne jedinice, a ne samu jedinicu.</span></span>
<span id="cb53-40"><a href="#cb53-40" tabindex="-1"></a></span>
<span id="cb53-41"><a href="#cb53-41" tabindex="-1"></a><span class="co"># Kreiranje prostornog zaostatka</span></span>
<span id="cb53-42"><a href="#cb53-42" tabindex="-1"></a><span class="co"># Izračunavamo prostorni zaostatak za svaku jedinicu koristeći prostornu težinsku matricu i varijablu cijena.</span></span>
<span id="cb53-43"><a href="#cb53-43" tabindex="-1"></a>spatial_lag <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(weights, Katastar_Analitika<span class="sc">$</span>MEDIJALNA_CIJENA_EUR_24)</span>
<span id="cb53-44"><a href="#cb53-44" tabindex="-1"></a></span>
<span id="cb53-45"><a href="#cb53-45" tabindex="-1"></a><span class="co"># Dodavanje prostornog zaostatka u dataset</span></span>
<span id="cb53-46"><a href="#cb53-46" tabindex="-1"></a><span class="co"># Ovo dodaje novu varijablu u dataset `Katastar_Analitika` koja sadrži izračunate prostorne zaostatke.</span></span>
<span id="cb53-47"><a href="#cb53-47" tabindex="-1"></a><span class="co"># Sada svaka jedinica ima dvije ključne informacije:</span></span>
<span id="cb53-48"><a href="#cb53-48" tabindex="-1"></a><span class="co"># 1. Vlastitu cijenu (`MEDIJALNA_CIJENA_EUR_24`).</span></span>
<span id="cb53-49"><a href="#cb53-49" tabindex="-1"></a><span class="co"># 2. Prosječnu cijenu u susjednim jedinicama (`Spatial_Lag`).</span></span>
<span id="cb53-50"><a href="#cb53-50" tabindex="-1"></a>Katastar_Analitika<span class="sc">$</span>Spatial_Lag <span class="ot">&lt;-</span> spatial_lag</span>
<span id="cb53-51"><a href="#cb53-51" tabindex="-1"></a></span>
<span id="cb53-52"><a href="#cb53-52" tabindex="-1"></a><span class="co"># Prostorni zaostatak je ključan za prostorne modele jer pokazuje obrasce prostorne povezanosti</span></span>
<span id="cb53-53"><a href="#cb53-53" tabindex="-1"></a><span class="co"># koji se često ne mogu vidjeti koristeći samo standardne metode analize.</span></span>
<span id="cb53-54"><a href="#cb53-54" tabindex="-1"></a><span class="co"># Izračun razlike između medijalne cijene nekretnina i prostornog zaostatka</span></span>
<span id="cb53-55"><a href="#cb53-55" tabindex="-1"></a><span class="co"># - `Razlika_Cijena_SpatialLag` mjeri koliko cijena u pojedinoj jedinici odstupa od prosjeka cijena u susjednim jedinicama.</span></span>
<span id="cb53-56"><a href="#cb53-56" tabindex="-1"></a><span class="co"># - Interpretacija:</span></span>
<span id="cb53-57"><a href="#cb53-57" tabindex="-1"></a><span class="co">#   - Pozitivna razlika: Cijena nekretnine u jedinici je veća od prosjeka susjeda.</span></span>
<span id="cb53-58"><a href="#cb53-58" tabindex="-1"></a><span class="co">#   - Negativna razlika: Cijena nekretnine u jedinici je manja od prosjeka susjeda.</span></span>
<span id="cb53-59"><a href="#cb53-59" tabindex="-1"></a><span class="co">#   - Vrijednost blizu nule: Cijena nekretnine u jedinici je slična prosjeku susjeda.</span></span>
<span id="cb53-60"><a href="#cb53-60" tabindex="-1"></a>Katastar_Analitika<span class="sc">$</span>Razlika_Cijena_SpatialLag <span class="ot">&lt;-</span> Katastar_Analitika<span class="sc">$</span>MEDIJALNA_CIJENA_EUR_24 <span class="sc">-</span> Katastar_Analitika<span class="sc">$</span>Spatial_Lag</span>
<span id="cb53-61"><a href="#cb53-61" tabindex="-1"></a></span>
<span id="cb53-62"><a href="#cb53-62" tabindex="-1"></a><span class="co"># Izračun omjera između medijalne cijene nekretnina i prostornog zaostatka</span></span>
<span id="cb53-63"><a href="#cb53-63" tabindex="-1"></a><span class="co"># - `Omjer_Cijena_SpatialLag` mjeri relativni odnos cijene u jedinici u usporedbi s prosjekom cijena u susjednim jedinicama.</span></span>
<span id="cb53-64"><a href="#cb53-64" tabindex="-1"></a><span class="co"># - Interpretacija:</span></span>
<span id="cb53-65"><a href="#cb53-65" tabindex="-1"></a><span class="co">#   - Omjer &gt; 1: Cijena nekretnine u jedinici je veća od prosjeka susjeda.</span></span>
<span id="cb53-66"><a href="#cb53-66" tabindex="-1"></a><span class="co">#   - Omjer &lt; 1: Cijena nekretnine u jedinici je manja od prosjeka susjeda.</span></span>
<span id="cb53-67"><a href="#cb53-67" tabindex="-1"></a><span class="co">#   - Omjer = 1: Cijena nekretnine u jedinici je jednaka prosjeku susjeda.</span></span>
<span id="cb53-68"><a href="#cb53-68" tabindex="-1"></a><span class="co"># - Omjer daje bolji uvid u relativne razlike, posebno kada su cijene različitih jedinica na različitim razinama.</span></span>
<span id="cb53-69"><a href="#cb53-69" tabindex="-1"></a>Katastar_Analitika<span class="sc">$</span>Omjer_Cijena_SpatialLag <span class="ot">&lt;-</span> Katastar_Analitika<span class="sc">$</span>MEDIJALNA_CIJENA_EUR_24 <span class="sc">/</span> Katastar_Analitika<span class="sc">$</span>Spatial_Lag</span>
<span id="cb53-70"><a href="#cb53-70" tabindex="-1"></a></span>
<span id="cb53-71"><a href="#cb53-71" tabindex="-1"></a><span class="co"># Vizualizacija prostornog zaostatka</span></span>
<span id="cb53-72"><a href="#cb53-72" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar_Analitika) <span class="sc">+</span></span>
<span id="cb53-73"><a href="#cb53-73" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Spatial_Lag)) <span class="sc">+</span></span>
<span id="cb53-74"><a href="#cb53-74" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>) <span class="sc">+</span>  <span class="co"># Gradijent boja za vizualizaciju</span></span>
<span id="cb53-75"><a href="#cb53-75" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb53-76"><a href="#cb53-76" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Prostorni zaostatak (Spatial Lag)&quot;</span>,</span>
<span id="cb53-77"><a href="#cb53-77" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Spatial Lag&quot;</span></span>
<span id="cb53-78"><a href="#cb53-78" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb53-79"><a href="#cb53-79" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-12.png" width="672" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="co"># Vizualizacija značajnosti lokalnog Moranovog indeksa</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar_Analitika) <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> LISA_Sig)) <span class="sc">+</span> <span class="co"># Boja prema značajnosti (significant / not significant)</span></span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Not Significant&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;Significant&quot;</span> <span class="ot">=</span> <span class="st">&quot;orange&quot;</span>)) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Značajnost lokalnog Moranovog indeksa (LISA)&quot;</span>,</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Signifikantnost&quot;</span></span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-13.png" width="672" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co"># 34. Vizualizacija prostornog klasteriranja</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a><span class="co"># Koristimo `ggplot2` za vizualizaciju prostornog klasteriranja temeljeno na kvadrantima.</span></span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a><span class="co"># - `geom_sf`: Prikazuje prostorne objekte</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a><span class="co"># - `aes(fill = factor(Quadr.mean))`: Boje prostorne jedinice prema njihovim kvadrantima</span></span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a><span class="co"># - `scale_fill_manual`: Definiramo boje za različite kategorije kvadranta</span></span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a><span class="co"># - `theme_minimal`: Pojednostavljuje izgled grafike</span></span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar_Analitika) <span class="sc">+</span></span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(Quadr.mean))) <span class="sc">+</span>  <span class="co"># Bojanje prema kvadrantima</span></span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;yellow&quot;</span>)) <span class="sc">+</span>  <span class="co"># Prilagođene boje</span></span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Lokalni Moranov indeks (LISA)&quot;</span>,  <span class="co"># Naslov vizualizacije</span></span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Kvadrant&quot;</span>  <span class="co"># Legenda za boje kvadranata</span></span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  <span class="co"># Minimalistički stil</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-14.png" width="672" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="co"># Vizualizacija prostornog klasteriranja s oznakama za MED_CIJENA</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar_Analitika) <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(Quadr.mean))) <span class="sc">+</span>  <span class="co"># Bojanje prema kvadrantima</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;yellow&quot;</span>)) <span class="sc">+</span>  <span class="co"># Prilagođene boje</span></span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(MED_CIJENA, <span class="dv">1</span>)), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span>  <span class="co"># Dodavanje oznaka (zaokruženo na 1 decimalu)</span></span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Lokalni Moranov indeks (LISA) s cijenama&quot;</span>,</span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Kvadrant&quot;</span></span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  <span class="co"># Minimalistički stil</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-15.png" width="672" /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="co"># Gearyjev C indeks je mjera prostorne autokorelacije.</span></span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a><span class="co"># Gearyjev C indeks se izračunava na temelju razlika između susjednih vrijednosti, ali rezultat se interpretira kao mjera sličnosti.</span></span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a><span class="co"># - Vrijednosti Gearyjevog C indeksa:</span></span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a><span class="co">#   - C = 1: Nema prostorne autokorelacije (nasumičan raspored).</span></span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a><span class="co">#   - C &lt; 1: Pozitivna prostorna autokorelacija (slične vrijednosti grupirane zajedno).</span></span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a><span class="co">#   - C &gt; 1: Negativna prostorna autokorelacija (različite vrijednosti susjedne).</span></span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a><span class="co"># Funkcija `geary.test()` koristi težinsku matricu i ciljnu varijablu za izračun Gearyjevog C indeksa.</span></span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a><span class="co"># Izračun Gearyjevog C indeksa za varijablu MEDIJALNA_CIJENA_EUR_24</span></span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a>geary_result <span class="ot">&lt;-</span> <span class="fu">geary.test</span>(Katastar_Analitika<span class="sc">$</span>MEDIJALNA_CIJENA_EUR_24, weights)</span>
<span id="cb57-12"><a href="#cb57-12" tabindex="-1"></a></span>
<span id="cb57-13"><a href="#cb57-13" tabindex="-1"></a><span class="co"># Prikaz rezultata</span></span>
<span id="cb57-14"><a href="#cb57-14" tabindex="-1"></a><span class="fu">print</span>(geary_result)</span></code></pre></div>
<pre><code>## 
##  Geary C test under randomisation
## 
## data:  Katastar_Analitika$MEDIJALNA_CIJENA_EUR_24 
## weights: weights   
## 
## Geary C statistic standard deviate = 3.8483, p-value = 5.947e-05
## alternative hypothesis: Expectation greater than statistic
## sample estimates:
## Geary C statistic       Expectation          Variance 
##         0.5133108         1.0000000         0.0159943</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="co"># Interpretacija:</span></span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a><span class="co"># - geary_result$estimate[1]: Vrijednost Gearyjevog C indeksa.</span></span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a><span class="co"># - geary_result$p.value: P-vrijednost testa (značajnost rezultata).</span></span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a><span class="co"># - Ako je p-vrijednost &lt; 0.05, autokorelacija je statistički značajna.</span></span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a><span class="co"># Gearyjev C indeks se često koristi zajedno s Moranovim indeksom za sveobuhvatnu analizu prostorne autokorelacije.</span></span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a><span class="co"># Izračun Getis-Ord Gi* statistike</span></span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a><span class="co"># - `localG()` izračunava Gi* statistiku za varijablu u prostornom objektu koristeći težinsku matricu.</span></span>
<span id="cb59-10"><a href="#cb59-10" tabindex="-1"></a><span class="co"># - Varijabla: MEDIJALNA_CIJENA_EUR_24</span></span>
<span id="cb59-11"><a href="#cb59-11" tabindex="-1"></a>gi_star <span class="ot">&lt;-</span> <span class="fu">localG</span>(Katastar_Analitika<span class="sc">$</span>MEDIJALNA_CIJENA_EUR_24, weights)</span>
<span id="cb59-12"><a href="#cb59-12" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" tabindex="-1"></a><span class="co"># Dodavanje rezultata u dataset</span></span>
<span id="cb59-14"><a href="#cb59-14" tabindex="-1"></a>Katastar_Analitika<span class="sc">$</span>Getis_Ord_Gi <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(gi_star)</span>
<span id="cb59-15"><a href="#cb59-15" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" tabindex="-1"></a><span class="co"># Vizualizacija Getis-Ord Gi* rezultata</span></span>
<span id="cb59-17"><a href="#cb59-17" tabindex="-1"></a><span class="co"># Prikazujemo klastere visokih i niskih vrijednosti na karti</span></span>
<span id="cb59-18"><a href="#cb59-18" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar_Analitika) <span class="sc">+</span></span>
<span id="cb59-19"><a href="#cb59-19" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Getis_Ord_Gi)) <span class="sc">+</span>  <span class="co"># Koristimo rezultate Gi* za bojanje</span></span>
<span id="cb59-20"><a href="#cb59-20" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb59-21"><a href="#cb59-21" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;red&quot;</span>,  <span class="co"># Plava za niske, crvena za visoke klastere</span></span>
<span id="cb59-22"><a href="#cb59-22" tabindex="-1"></a>    <span class="at">midpoint =</span> <span class="dv">0</span>,                              <span class="co"># Neutralna točka</span></span>
<span id="cb59-23"><a href="#cb59-23" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Gi*&quot;</span>                               <span class="co"># Oznaka legende</span></span>
<span id="cb59-24"><a href="#cb59-24" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-25"><a href="#cb59-25" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb59-26"><a href="#cb59-26" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Getis-Ord Gi* statistika: Klasteri cijena (2024)&quot;</span>,</span>
<span id="cb59-27"><a href="#cb59-27" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Gi* vrijednost&quot;</span></span>
<span id="cb59-28"><a href="#cb59-28" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-29"><a href="#cb59-29" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-16.png" width="672" /></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="co"># Ispis osnovnih rezultata Gi* statistike</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a><span class="fu">summary</span>(gi_star)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -2.5509 -0.3420  0.8271  0.4447  1.2511  2.1998</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="co"># Izračun p-vrijednosti za Gi* rezultate</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="co"># - Pretpostavka: Gi* statistika prati standardnu normalnu distribuciju.</span></span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a><span class="co"># - P-vrijednost izračunavamo kao dvostrani test na temelju apsolutnih vrijednosti Gi* rezultata.</span></span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a><span class="co"># - Nova varijabla `Gi_p_value` sadrži p-vrijednosti za svaku prostornu jedinicu.</span></span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>Katastar_Analitika<span class="sc">$</span>Gi_p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(gi_star))  <span class="co"># Dvostrani test</span></span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a><span class="co"># Dodavanje značajnosti (kategorije prema p-vrijednostima)</span></span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a><span class="co"># - Rezultate značajnosti kategoriziramo prema pragovima p-vrijednosti:</span></span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a><span class="co">#   - Vrlo značajno (p &lt; 0.01): Snažni klasteri (hotspots/coldspots).</span></span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a><span class="co">#   - Značajno (p &lt; 0.05): Umjereni klasteri.</span></span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a><span class="co">#   - Nije značajno: Neutralna područja bez klastera.</span></span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>Katastar_Analitika<span class="sc">$</span>Gi_significance <span class="ot">&lt;-</span> <span class="fu">cut</span>(</span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a>  Katastar_Analitika<span class="sc">$</span>Gi_p_value,</span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>),  <span class="co"># Pragovi za kategorizaciju</span></span>
<span id="cb62-15"><a href="#cb62-15" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Vrlo značajno (p &lt; 0.01)&quot;</span>, <span class="st">&quot;Značajno (p &lt; 0.05)&quot;</span>, <span class="st">&quot;Nije značajno&quot;</span>)  <span class="co"># Kategorije</span></span>
<span id="cb62-16"><a href="#cb62-16" tabindex="-1"></a>)</span>
<span id="cb62-17"><a href="#cb62-17" tabindex="-1"></a></span>
<span id="cb62-18"><a href="#cb62-18" tabindex="-1"></a><span class="co"># Vizualizacija značajnosti Gi* rezultata</span></span>
<span id="cb62-19"><a href="#cb62-19" tabindex="-1"></a><span class="co"># - ggplot2 koristi kategorije značajnosti za prikaz klastera na prostornoj karti.</span></span>
<span id="cb62-20"><a href="#cb62-20" tabindex="-1"></a><span class="co"># - Boje za kategorije:</span></span>
<span id="cb62-21"><a href="#cb62-21" tabindex="-1"></a><span class="co">#   - Crvena: Vrlo značajni klasteri (p &lt; 0.01).</span></span>
<span id="cb62-22"><a href="#cb62-22" tabindex="-1"></a><span class="co">#   - Narančasta: Značajni klasteri (p &lt; 0.05).</span></span>
<span id="cb62-23"><a href="#cb62-23" tabindex="-1"></a><span class="co">#   - Siva: Područja bez značajnih klastera.</span></span>
<span id="cb62-24"><a href="#cb62-24" tabindex="-1"></a><span class="fu">ggplot</span>(Katastar_Analitika) <span class="sc">+</span></span>
<span id="cb62-25"><a href="#cb62-25" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Gi_significance)) <span class="sc">+</span>  <span class="co"># Prikaz prema značajnosti</span></span>
<span id="cb62-26"><a href="#cb62-26" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb62-27"><a href="#cb62-27" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;grey&quot;</span>),  <span class="co"># Definicija boja za kategorije</span></span>
<span id="cb62-28"><a href="#cb62-28" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Značajnost&quot;</span>                  <span class="co"># Oznaka za legendu</span></span>
<span id="cb62-29"><a href="#cb62-29" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-30"><a href="#cb62-30" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb62-31"><a href="#cb62-31" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Značajnost Getis-Ord Gi* statistike&quot;</span>,  <span class="co"># Naslov karte</span></span>
<span id="cb62-32"><a href="#cb62-32" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Kategorija značajnosti&quot;</span>               <span class="co"># Oznaka legende</span></span>
<span id="cb62-33"><a href="#cb62-33" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-34"><a href="#cb62-34" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  <span class="co"># Minimalistički stil vizualizacije</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Kod_2-17.png" width="672" /></p>
<!--chapter:end:index.Rmd-->
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

</body>

</html>
